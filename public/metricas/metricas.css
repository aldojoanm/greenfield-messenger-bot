:root{
  --bg:#0f1320; --panel:#141a2a; --muted:#a3adc2; --text:#eaf0ff; --accent:#1b6cff;
  --card:#151c2f; --ring: rgba(27,108,255,.15);
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; background:radial-gradient(1200px 600px at 80% -10%, #1a2140 0%, transparent 50%), var(--bg);
  color:var(--text); font-family:ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
}

.topbar{
  display:flex; justify-content:space-between; align-items:center;
  padding:18px 22px; background:rgba(255,255,255,.02); backdrop-filter: blur(6px); border-bottom:1px solid rgba(255,255,255,.06);
  position:sticky; top:0; z-index:10;
}
.brand h1{ margin:0; font-size:20px; }
.brand small{ color:var(--muted) }

/* Controles */
.ctl{ display:flex; gap:12px; align-items:center; flex-wrap:wrap; }
.ctl label{ color:var(--text); font-size:14px; }
select{
  background:var(--panel); color:var(--text); border:1px solid rgba(255,255,255,.08);
  border-radius:10px; padding:8px 10px; outline:none;
}
.btn{
  background:var(--accent); color:white; border:none; border-radius:10px; padding:9px 14px; font-weight:700; cursor:pointer;
  box-shadow:0 8px 24px var(--ring); transition:.15s transform ease, .2s box-shadow ease;
}
.btn:hover{ transform:translateY(-1px); box-shadow:0 12px 26px var(--ring); }

.wrap{ max-width:1200px; margin:24px auto; padding:0 16px; overflow-x:hidden; }

/* KPIs */
.kpis{
  display:grid; grid-template-columns:repeat(6, 1fr); gap:12px; margin-bottom:16px;
}
.kpi{
  background:var(--panel); color:var(--text);
  padding:14px; border-radius:14px; border:1px solid rgba(255,255,255,.06);
  text-align:left; cursor:pointer; transition:transform .08s ease, box-shadow .15s ease;
}
.kpi:focus{ outline:none; }
.kpi:hover{ transform:translateY(-1px); box-shadow:0 10px 28px rgba(0,0,0,.25); }
.kpi.active{ border-color:rgba(27,108,255,.55); box-shadow:0 0 0 3px rgba(27,108,255,.15) inset; }
.kpi-v{ font-size:22px; font-weight:800; color:var(--text); }
.kpi-l{ color:var(--muted); margin-top:4px }

/* Grilla principal */
.grid{ display:grid; gap:16px; grid-template-columns:1fr 1fr; }
.card{
  background:var(--card); border:1px solid rgba(255,255,255,.06); border-radius:14px; padding:16px;
  box-shadow:0 10px 30px rgba(0,0,0,.25); overflow:hidden;
}
.card.wide{ grid-column:1 / -1; }
.card h2{ margin:0 0 10px; font-size:16px; color:#dfe6ff }

/* Tabla */
.table-wrap{ overflow:auto; max-height:420px; border-radius:10px; }
.tbl{ width:100%; border-collapse:collapse; }
.tbl th, .tbl td{ padding:10px 12px; border-bottom:1px solid rgba(255,255,255,.06); white-space:nowrap; }
.tbl th{ position:sticky; top:0; background:#0f1527; }

/* Tamaños dedicados */
#chLine, #chBar{
  width:100% !important;
  height:300px !important;
  display:block;
}

/* Donas en tarjeta */
.pie-card canvas,
#chPieSel{
  width:100% !important;
  height:260px !important;
  display:block;
}
.hidden{ display:none; }

/* Móvil */
@media (max-width:980px){
  .kpis{ grid-template-columns:repeat(3,1fr) }
  .grid{ grid-template-columns:1fr; }
}
@media (max-width:640px){
  .ctl{ width:100%; justify-content:flex-start; gap:8px; }
  .ctl label{ display:flex; align-items:center; gap:6px; }
  /* mismo ancho para Mes y Semana y que no se estiren */
  .ctl select{ width:140px; max-width:140px; }
  .btn{ padding:8px 12px; }
}
